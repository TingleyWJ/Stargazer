https://community.gamedev.tv/t/took-me-over-10-hours-to-convert-this-to-c-what-a-learning-progress-i-want-to-share-my-code-with-you-guys-hopefully-it-helps-somebody/23098